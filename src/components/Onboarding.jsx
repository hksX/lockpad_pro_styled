import React, { useState } from 'react'; import { motion } from 'framer-motion'; import CryptoJS from 'crypto-js'; import { encryptText } from '../utils/crypto'; const SALT='lockpad_salt', VER='lockpad_verifier'; function score(p){ let s=0; if(p.length>=8)s++; if(/[A-Z]/.test(p))s++; if(/[0-9]/.test(p))s++; if(/[^A-Za-z0-9]/.test(p))s++; return s; } export default function Onboarding({onCreated}){ const [pw,setPw]=useState(''); const [pw2,setPw2]=useState(''); const [show,setShow]=useState(false); const doCreate=()=>{ if(pw.length<6) return alert('Choose at least 6 chars'); if(pw!==pw2) return alert('Passwords do not match'); const salt = CryptoJS.lib.WordArray.random(16).toString(CryptoJS.enc.Hex); localStorage.setItem(SALT,salt); const {ciphertext,iv} = encryptText('lockpad-styled-verifier', pw, salt); localStorage.setItem(VER, JSON.stringify({ciphertext, iv})); onCreated(pw); }; const labels=['Very Weak','Weak','Okay','Strong','Very Strong']; return (<div className='bg-hero'><div className='glass' style={{display:'flex',gap:24,alignItems:'center'}}><div style={{flex:'0 0 160px',textAlign:'center'}}><img src='/assets/lock.png' alt='lock' style={{width:120}} /></div><div style={{flex:1}}><motion.div initial={{opacity:0,y:10}} animate={{opacity:1,y:0}} transition={{duration:0.6}}><h2 style={{textAlign:'center',margin:0}}>Welcome to <span style={{color:'var(--accent)'}}>LockPad Pro</span></h2><p className='small' style={{textAlign:'center'}}>Create a master password to secure notes locally.</p><input className='input' type={show?'text':'password'} placeholder='Master password' value={pw} onChange={e=>setPw(e.target.value)} /><input className='input' type={show?'text':'password'} placeholder='Confirm password' value={pw2} onChange={e=>setPw2(e.target.value)} /><div style={{display:'flex',justifyContent:'space-between',alignItems:'center'}}><label><input type='checkbox' checked={show} onChange={e=>setShow(e.target.checked)} /> Show</label><div className='small'>Strength: <strong>{labels[score(pw)]}</strong></div></div><div style={{textAlign:'center'}}><button className='btn' onClick={doCreate}>Set Password & Continue</button></div></motion.div></div></div></div>); }
