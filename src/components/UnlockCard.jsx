import React, { useState } from 'react'; import { decryptText } from '../utils/crypto'; import { motion } from 'framer-motion'; const SALT='lockpad_salt', VER='lockpad_verifier'; export default function UnlockCard({onUnlock, onCreate}){ const [pw,setPw]=useState(''); const [show,setShow]=useState(false); const doUnlock=()=>{ const v = localStorage.getItem(VER); const salt = localStorage.getItem(SALT); if(!v || !salt){ alert('No password set yet. Please create a new password.'); onCreate(); return; } const {ciphertext, iv} = JSON.parse(v); try{ const dec = decryptText(ciphertext, pw, salt, iv); if(dec === 'lockpad-styled-verifier'){ onUnlock(pw); } else alert('Wrong password'); }catch(e){ alert('Wrong password'); } }; return (<div className='bg-hero'><div className='glass' style={{maxWidth:640}}><motion.div initial={{opacity:0, y:8}} animate={{opacity:1, y:0}} transition={{duration:0.45}}><div style={{textAlign:'center'}}><img src='/assets/lock.png' style={{width:88, marginBottom:8}} alt='lock' /><h2 style={{margin:0}}>LockPad Pro</h2><p className='small'>Enter your master password to unlock notes.</p><input className='input' type={show?'text':'password'} value={pw} onChange={e=>setPw(e.target.value)} placeholder='Master password' /><div style={{display:'flex',justifyContent:'space-between',alignItems:'center'}}><label><input type='checkbox' checked={show} onChange={e=>setShow(e.target.checked)} /> Show</label><div><button className='btn' onClick={doUnlock}>Unlock</button></div></div><div className='small' style={{marginTop:8}}>First time? <a href='#' onClick={e=>{e.preventDefault(); onCreate();}}>Create password</a></div></div></motion.div></div></div>); }
